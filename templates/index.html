{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}

<h1 style="text-align:center;">Hello, Ticket System!</h1>

{% if jobs %}
<ul style="list-style:none; padding:0; margin:0;">
    {% for j in jobs %}
    <li class="job-card">

        <!-- Header (click to expand) -->
        <div class="job-header" onclick="toggleJob('{{ j.id }}')">
            <span class="job-title">#{{ j.id }} — {{ j.name }}</span>
            <span class="job-toggle" id="arrow-{{ j.id }}">▼</span>
        </div>

        <!-- Hidden content -->
        <div class="job-content" id="job-{{ j.id }}">
            <div><strong>Operator:</strong> {{ j.operator }}</div>

            <div><strong>Description:</strong><br>
                {{ j.description }}
            </div>

            <div><strong>Impact:</strong> {{ j.impact }}</div>
            <div><strong>Impact on Customer:</strong> {{ j.impact_customer }}</div>

            {% if j.impact_desc %}
            <div>
                <strong>Impact Details:</strong><br>
                {{ j.impact_desc }}
            </div>
            {% endif %}

            <div>
                <strong>Start time:</strong> {{ j.start_time }}<br>
                <strong>End time:</strong> {{ j.end_time }}
            </div>
        </div>

    </li>
    {% endfor %}
</ul>
{% else %}
<p>No jobs yet.</p>
{% endif %}

<script>
function toggleJob(id) {
    let content = document.getElementById("job-" + id);
    let arrow = document.getElementById("arrow-" + id);

    if (content.style.display === "block") {
        content.style.display = "none";
        arrow.style.transform = "rotate(0deg)";
    } else {
        content.style.display = "block";
        arrow.style.transform = "rotate(180deg)";
    }
}
</script>

{% endblock %}
