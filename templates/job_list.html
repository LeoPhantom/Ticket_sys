<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header class="nav">
        <nav>
            <a href="{{ url_for('index') }}">Home</a>
            <a href="{{ url_for('new_ticket') }}">New Ticket</a>
            <a href="{{ url_for('view_tickets') }}">View Tickets</a>
            <a href="{{ url_for('new_job') }}">View Jobs</a> 
        </nav>
    </header>

    <h1>Hello, Ticket System!</h1>
    <p>Welcome Jobs.</p>
    <button id="openJobModal">New Job</button>
        <div id="jobModal" class="modal">
  <div class="modal-content">

            <h2>Create New Job</h2>

            <form method="POST">

            <label>Name:</label>
            <input type="text" name="name" required>

            <label>Operator:</label>
            <input type="text" name="operator" required>

            <label>Description:</label>
            <textarea name="description" required></textarea>

            <label>Impact:</label>
            <select name="impact">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>

            <label>Impact on customer:</label>
            <select name="impact_customer">
                <option value="yes">Yes</option>
                <option value="no">No</option>
            </select>

            <label>What is the impact:</label>
            <textarea name="impact_desc"></textarea>

            <label>Time Start:</label>
            <input type="datetime-local" name="time_start" required>

            <label>Time End:</label>
            <input type="datetime-local" name="time_end">

            <button type="submit">Create Job</button>
            </form>

            <button id="closeJobModal">Close</button>
          
        </div>
</div>

{% if jobs %}
    <ul style="list-style:none; padding:0; margin:0;">

    {% for j in jobs %}
        <li style="
            background:#fff;
            padding:18px;
            margin-bottom:15px;
            border-radius:10px;
            border:1px solid #e0e0e0;
            box-shadow:0 2px 5px rgba(0,0,0,0.05);
        ">
            <div style="font-size:20px; font-weight:bold; margin-bottom:5px;">
                #{{ j.id }} â€” {{ j.name }}
            </div>

            <div style="margin-bottom:10px; color:#555;">
                <strong>Operator:</strong> {{ j.operator }}
            </div>

            <div style="margin-bottom:10px;">
                <strong>Description:</strong><br>
                <span style="color:#444;">{{ j.description }}</span>
            </div>

            <div style="margin-bottom:5px;">
                <strong>Impact:</strong> {{ j.impact }}
            </div>

            <div style="margin-bottom:5px;">
                <strong>Impact on Customer:</strong> {{ j.impact_customer }}
            </div>

            {% if j.impact_desc %}
            <div style="margin-bottom:10px;">
                <strong>Impact Details:</strong><br>
                <span style="color:#555;">{{ j.impact_desc }}</span>
            </div>
            {% endif %}

            <div style="margin-top:10px;">
                <strong>Start time:</strong> {{ j.start_time }}<br>
                <strong>End time:</strong> {{ j.end_time }}
            </div>

            <!-- DELETE BUTTON WORKS NOW -->
            <form action="{{ url_for('delete_job', job_id=j.id) }}" method="POST" style="margin-top:12px;">
                <button type="submit"
                    onclick="return confirm('Delete this job permanently?');"
                    style="background:#d9534f; color:white; padding:6px 12px;
                        border:none; border-radius:5px; cursor:pointer;">
                    Delete
                </button>
            </form>

        </li>
    {% endfor %}

    </ul>
{% else %}
    <p>No jobs yet.</p>
{% endif %}


</body>
<script>
        document.getElementById("openJobModal").onclick = function() {
            document.getElementById("jobModal").style.display = "block";
        }

        document.getElementById("closeJobModal").onclick = function() {
            document.getElementById("jobModal").style.display = "none";
        }
</script>

</html>